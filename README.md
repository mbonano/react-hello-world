# React / Babel / Webpack Basic Reference Implementation #

### Description ###

This project serves as a reference implementation for a RESTful micro-service. This project demonstrates how to use 
CXF JAX-RS services and Camel routes with Spring Boot. 

### Technology Stack ###

It is highly recommended that engineers become acquainted with various supporting technologies. You can find more information here:

- Read more about [Docker](https://www.docker.com/tryit/) *(https://www.docker.com/tryit/)*
- Read more about [Docker Compose](https://docs.docker.com/compose/) *(https://docs.docker.com/compose/)*

### Developer Environment ###

*NOTE*: This environment has been configured and tested on Linux, OSX & Windows 10. If you are running any other operating systems
or previous versions, it is recommended to develop locally without docker, unless you have experience with docker on you OS and version.

Since docker is dependent on key components of the Linux kernel, it must be run on Linux. If a developer is already running Linux
natively, she needs only to [install docker on Linux](https://docs.docker.com/engine/installation/linux/ubuntulinux/) in order to run
the application locally. If, however, a developer is running on Windows or Mac, then she must run docker on a local VM or hypervisor.
 
It is suggested that developers install docker engine locally on Windows/OSX in order to support this requirement:

- Install [Docker for Windows](https://docs.docker.com/docker-for-windows/) *(https://docs.docker.com/docker-for-windows/)*
- Install [Docker for Mac](https://docs.docker.com/docker-for-mac/) *(https://docs.docker.com/docker-for-mac/)*

### Run the application ###

You can execute the following command to run the application:

    $ ./app start dev

The above command will launch the dev container, which has all development dependencies pre-installed.
This container will start the application via maven, equivalent to 'mvn spring-boot:run':

You can, then, access the APIs as follows:

- Echo API: An API that echo's the value of the supplied "message" path parameter
    - Service Class: com.scholastic.integration.reference.api.SimpleApiService
    - Endpoints:
        - Returns message passed in path parameter as plain text response
            `curl http://localhost:9011/echo/text/some-message`
        - Returns message passed in path parameter as json response
            `curl http://localhost:9011/echo/json/some-message`
- Composite API: An API that returns a resource generated by a Camel route
    - Service Class: com.scholastic.integration.reference.api.CompositeApiService
    - Endpoints:
        - Returns composite response with id matching the supplied id passed as a path parameter
            `curl http://localhost:9011/composite/some-id`
    
Additionally, there are auto-generated endpoints in support of release and operational concerns:

- Swagger JSON API description: http://localhost:9011/swagger.json
- Swagger UI Browser: http://localhost:9011/api-docs?url=/swagger.json
- CXF Services page (which lists endpoints and swagger link): http://localhost:9011/info
- System metrics: http://localhost:9011/system/metrics 
- Service health check page: http://localhost:9011/system/health

### Build an executable JAR ###

Execute the following command to build an executable JAR, which contains an embedded Tomcat servlet:

    $ ./app mvn clean package
    
### Publish application changes ###

Perform the following in order to publish application changes:

1. Increment the application version in the pom.xml file 
2. Execute 'package' step, which should start the application container, compile application and run all unit/in-memory integration tests

    `$ ./app package`
     
3. Execute 'build' step, which should build a new image containing your nested assets (binaries, etc.)

    `$ ./app build`
    
4. Execute 'publish' step, which should push the new image to the image repository and deploy the application to its first stage (usually dev)

    `$ ./app publish`
    
5. Execute 'clean' step, which should stop the containers and remove the assets related to the build

    `$ ./app clean`
        
### Promote the application across stages ###

Once changes have been published (see above section for more details), the application can be 
promoted across specified stages, each of which is usually associated with distinct environments
and configurations. Stages are defined in the 'app.yml' file in the root of the project.

    $ ./app promote [STAGE] (e.g ./app promote qa)
     
Old containers will be stopped automatically, and replaced with new ones. Images, however, will 
remain in order to support rollbacks.

### Additional Commands ###

Below is a list of additional commands meant to support the development process:

    ./app start         # start the application 
    ./app start dev     # start the application in a dev-enabled environment
    ./app stop          # stop the application
    ./app stop dev      # stop the dev application
    ./app restart       # restart the application
    ./app restart dev   # restart the dev application
    ./app clean-all.    # stop all applications, remove all containers and remove all images
    ./app logs          # tail logs of running application
    ./app mvn [args]    # execute maven commands within dev-enabled container ('./app start dev' must be first executed)
    ./app ssh           # create terminal session on running container
    
### Committing to this project ###
    
Contributions to this project are managed via a fairly common branching strategy. The examples supplied below make use of the git flow CLI tool.
More information can be found on the [GitFlow GitHub Page](https://github.com/nvie/gitflow). 

Any new commits should _always_ begin with the creation of a feature branch:

    $ git flow feature start MYFEATURE

All commits should be done on the created feature branch. Once all development is completed, the feature branch should be published:

    $ git flow feature publish MYFEATURE

A pull request should then be submitted by the contributor, which is subsequently followed by a code review before a merge into the develop branch.

